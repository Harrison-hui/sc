
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Harrison">
      
      
        <link rel="canonical" href="https://biomed-notebook.cn/%E5%8D%95%E7%BB%86%E8%83%9E/01.%2BAnData%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%2Bf42be259-849d-43ee-bd34-e610de1f0ede/">
      
      
        <link rel="prev" href="../../numpy/2.%2B%E6%95%B0%E7%BB%84%E7%9A%84%E6%93%8D%E4%BD%9C%2Bb1e5aded-809e-4f5e-8eeb-bf5278c70410/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>01.AnData数据结构 - 数据分析笔记</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="数据分析笔记" class="md-header__button md-logo" aria-label="数据分析笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            数据分析笔记
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              01.AnData数据结构
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="数据分析笔记" class="md-nav__button md-logo" aria-label="数据分析笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    数据分析笔记
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    numpy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            numpy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../numpy/1.%2B%E6%95%B0%E7%BB%84%E7%9A%84%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%88%9B%E5%BB%BA%2B101c0975-b67c-4216-8719-591a35b324bb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.+数组的概念及创建
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../numpy/2.%2B%E6%95%B0%E7%BB%84%E7%9A%84%E6%93%8D%E4%BD%9C%2Bb1e5aded-809e-4f5e-8eeb-bf5278c70410/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.+数组的操作
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pandas
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scipy
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    matplotlib
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    seaborn
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    单细胞
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            单细胞
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    01.AnData数据结构
    
  </span>
  

      </a>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    机器学习
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image.png" /></p>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%201.png" /></p>
<h1 id="_1">导入模块</h1>
<pre><code class="language-Python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import pooch
import anndata
import scanpy as sc
</code></pre>
<h1 id="_2">数据下载与导入</h1>
<p>下载并导入.h5ad文件：已经预处理的 PBMC 数据集</p>
<p><a href="../01.f42be259-849d-43ee-bd34-e610de1f0ede/scverse-getting-started-anndata-pbmc3k_processed.h5ad">scverse-getting-started-anndata-pbmc3k_processed.h5ad</a></p>
<pre><code class="language-Python">datapath = &quot;./data/scverse-getting-started-anndata-pbmc3k_processed.h5ad&quot;
adata = anndata.read_h5ad(datapath)
&quot;&quot;&quot;
AnnData object with n_obs × n_vars = 2638 × 11505
    obs: 'n_genes', 'percent_mito', 'n_counts', 'louvain_cell_types'
    var: 'gene_names', 'n_cells', 'gene_ids'
    uns: 'louvain', 'louvain_colors', 'pca'
    obsm: 'X_pca', 'X_tsne', 'X_umap'
    layers: 'raw'
    obsp: 'distances_all'
&quot;&quot;&quot;

adata_df = adata.to_df()
&quot;&quot;&quot;
gene_names        LINC00115  NOC2L  KLHL17  PLEKHN1  HES4     ISG15  AGRN  ...    MT-CO3    MT-ND3   MT-ND4L    MT-ND4    MT-ND5  MT-ND6    MT-CYB
cell_barcode                                                               ...                                                                    
AAACATACAACCAC-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  1.718197  0.649662  0.000000  2.317369  0.649662     0.0  1.538924
AAACATTGAGCTAC-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  2.049184  0.642665  0.000000  2.764773  0.372095     0.0  1.527396
AAACATTGATCAGC-1        0.0    0.0     0.0      0.0   0.0  0.532456   0.0  ...  1.338269  0.000000  0.000000  1.134407  0.878057     0.0  1.338269
AAACCGTGCTTCCG-1        0.0    0.0     0.0      0.0   0.0  2.144639   0.0  ...  1.470325  0.000000  0.608494  1.256467  0.984071     0.0  0.984071
AAACCGTGTATGCG-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  1.179840  0.000000  0.000000  0.000000  1.706149     0.0  1.179840
...                     ...    ...     ...      ...   ...       ...   ...  ...       ...       ...       ...       ...       ...     ...       ...
TTTCGAACTCTCAT-1        0.0    0.0     0.0      0.0   0.0  2.298200   0.0  ...  1.811211  0.494533  0.000000  0.494533  0.000000     0.0  0.494533
TTTCTACTGAGGCA-1        0.0    0.0     0.0      0.0   0.0  0.496017   0.0  ...  1.703869  0.000000  0.496017  0.826074  0.496017     0.0  1.272192
TTTCTACTTCCTCG-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  2.320006  0.000000  0.000000  2.320006  0.000000     0.0  1.831505
TTTGCATGAGAGGC-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  1.670896  0.000000  1.150086  0.000000  0.000000     0.0  1.150086
TTTGCATGCCTCAC-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  0.750617  0.000000  0.000000  0.750617  0.000000     0.0  1.471306

[2638 rows x 11505 columns]
&quot;&quot;&quot;

adata_shape = adata.shape
&quot;&quot;&quot;
(2638, 11505)
&quot;&quot;&quot;

adata_nobs = adata.n_obs              # 细胞数量
&quot;&quot;&quot;
2638
&quot;&quot;&quot;

adata_obs_names = adata.obs_names     # 细胞条码
&quot;&quot;&quot;
Index(['AAACATACAACCAC-1', 'AAACATTGAGCTAC-1', 'AAACATTGATCAGC-1',
       'AAACCGTGCTTCCG-1', 'AAACCGTGTATGCG-1', 'AAACGCACTGGTAC-1',
       'AAACGCTGACCAGT-1', 'AAACGCTGGTTCTT-1', 'AAACGCTGTAGCCA-1',
       'AAACGCTGTTTCTG-1',
       ...
       'TTTCAGTGTCACGA-1', 'TTTCAGTGTCTATC-1', 'TTTCAGTGTGCAGT-1',
       'TTTCCAGAGGTGAG-1', 'TTTCGAACACCTGA-1', 'TTTCGAACTCTCAT-1',
       'TTTCTACTGAGGCA-1', 'TTTCTACTTCCTCG-1', 'TTTGCATGAGAGGC-1',
       'TTTGCATGCCTCAC-1'],
      dtype='object', name='cell_barcode', length=2638)
&quot;&quot;&quot;

adata_obs_colums = adata.obs_keys()   # 细胞信息列名
&quot;&quot;&quot;
['n_genes', 'percent_mito', 'n_counts', 'louvain_cell_types']
&quot;&quot;&quot;

adata_nvars = adata.n_vars            # 基因数量
&quot;&quot;&quot;
11505
&quot;&quot;&quot;

adata_var_names = adata.var_names     # 基因名称
&quot;&quot;&quot;
Index(['LINC00115', 'NOC2L', 'KLHL17', 'PLEKHN1', 'HES4', 'ISG15', 'AGRN',
       'C1orf159', 'TNFRSF18', 'TNFRSF4',
       ...
       'MT-CO2', 'MT-ATP8', 'MT-ATP6', 'MT-CO3', 'MT-ND3', 'MT-ND4L', 'MT-ND4',
       'MT-ND5', 'MT-ND6', 'MT-CYB'],
      dtype='object', name='gene_names', length=11505)
&quot;&quot;&quot;

adata_var_colums = adata.var_keys()   # 基因信息列名
&quot;&quot;&quot;
['gene_names', 'n_cells', 'gene_ids']
&quot;&quot;&quot;
</code></pre>
<pre><code class="language-Python">adata1 = adata[0:100, [&quot;MT-CO3&quot;, &quot;MT-CYB&quot;]]    # 索引类似于pandas
&quot;&quot;&quot;
View of AnnData object with n_obs × n_vars = 100 × 2
    obs: 'n_genes', 'percent_mito', 'n_counts', 'louvain_cell_types'
    var: 'gene_names', 'n_cells', 'gene_ids'
    uns: 'louvain', 'louvain_colors', 'pca'
    obsm: 'X_pca', 'X_tsne', 'X_umap'
    layers: 'raw'
    obsp: 'distances_all'
&quot;&quot;&quot;

adata1_df = adata1.to_df()
&quot;&quot;&quot;
gene_names          MT-CO3    MT-CYB
cell_barcode
AAACATACAACCAC-1  1.718197  1.538924
AAACATTGAGCTAC-1  2.049184  1.527396
AAACATTGATCAGC-1  1.338269  1.338269
AAACCGTGCTTCCG-1  1.470325  0.984071
AAACCGTGTATGCG-1  1.179840  1.179840
...                    ...       ...
AAGATGGAGATAAG-1  1.872285  1.322174
AAGATTACAACCTG-1  2.236686  1.419691
AAGATTACAGATCC-1  1.574272  1.778458
AAGATTACCCGTTC-1  2.005355  2.005355
AAGATTACCGCCTT-1  2.014749  2.106685

[100 rows x 2 columns]
&quot;&quot;&quot;
</code></pre>
<h1 id="_3">数据结构</h1>
<h2 id="observations-variablesx">活动计数矩阵(observations × variables)：X</h2>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%202.png" /></p>
<p>储存为稀疏矩阵（只将非零值及其坐标/索引显式存储在数据矩阵中）</p>
<pre><code class="language-Python">&quot;&quot;&quot;
储存归一化和log(1+x)转换的 mRNA 计数
&quot;&quot;&quot;

X = adata.X                                                                         # 稀疏矩阵
&quot;&quot;&quot;
&lt;Compressed Sparse Row sparse matrix of dtype 'float32'
        with 2076576 stored elements and shape (2638, 11505)&gt;
  Coords        Values
  (0, 19)       0.6496620774269104
  (0, 52)       0.6496620774269104
  (0, 58)       1.0402015447616577
  (0, 118)      0.6496620774269104
  (0, 131)      0.6496620774269104
  ...
  (2637, 11493) 0.7506172060966492
  (2637, 11494) 2.177945375442505
  (2637, 11498) 0.7506172060966492
  (2637, 11501) 0.7506172060966492
  (2637, 11504) 1.4713064432144165
&quot;&quot;&quot;

X_df = pd.DataFrame(X.todense(), index=adata.obs_names, columns=adata.var_names)    # 普通矩阵
X_df = pd.DataFrame(X.toarray(), index=adata.obs_names, columns=adata.var_names)
X_df = adata.to_df()
&quot;&quot;&quot;
gene_names        LINC00115  NOC2L  KLHL17  PLEKHN1  HES4     ISG15  AGRN  ...    MT-CO3    MT-ND3   MT-ND4L    MT-ND4    MT-ND5  MT-ND6    MT-CYB
cell_barcode                                                               ...                                                                    
AAACATACAACCAC-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  1.718197  0.649662  0.000000  2.317369  0.649662     0.0  1.538924
AAACATTGAGCTAC-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  2.049184  0.642665  0.000000  2.764773  0.372095     0.0  1.527396
AAACATTGATCAGC-1        0.0    0.0     0.0      0.0   0.0  0.532456   0.0  ...  1.338269  0.000000  0.000000  1.134407  0.878057     0.0  1.338269
AAACCGTGCTTCCG-1        0.0    0.0     0.0      0.0   0.0  2.144639   0.0  ...  1.470325  0.000000  0.608494  1.256467  0.984071     0.0  0.984071
AAACCGTGTATGCG-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  1.179840  0.000000  0.000000  0.000000  1.706149     0.0  1.179840
...                     ...    ...     ...      ...   ...       ...   ...  ...       ...       ...       ...       ...       ...     ...       ...
TTTCGAACTCTCAT-1        0.0    0.0     0.0      0.0   0.0  2.298200   0.0  ...  1.811211  0.494533  0.000000  0.494533  0.000000     0.0  0.494533
TTTCTACTGAGGCA-1        0.0    0.0     0.0      0.0   0.0  0.496017   0.0  ...  1.703869  0.000000  0.496017  0.826074  0.496017     0.0  1.272192
TTTCTACTTCCTCG-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  2.320006  0.000000  0.000000  2.320006  0.000000     0.0  1.831505    
TTTGCATGAGAGGC-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  1.670896  0.000000  1.150086  0.000000  0.000000     0.0  1.150086    
TTTGCATGCCTCAC-1        0.0    0.0     0.0      0.0   0.0  0.000000   0.0  ...  0.750617  0.000000  0.000000  0.750617  0.000000     0.0  1.471306    

[2638 rows x 11505 columns]
&quot;&quot;&quot;

X_data = X.data
&quot;&quot;&quot;
[0.6496621 0.6496621 1.0402015 ... 0.7506172 0.7506172 1.4713064]
&quot;&quot;&quot;

X_indices = X.indices
&quot;&quot;&quot;
[   19    52    58 ... 11498 11501 11504]
&quot;&quot;&quot;

X_nonzero = X.nnz
&quot;&quot;&quot;
2076576
&quot;&quot;&quot;

X_shape = X.shape
&quot;&quot;&quot;
(2638, 11505)
&quot;&quot;&quot;
</code></pre>
<h2 id="xobservations-variableslayers">X替代版本(observations × variables)：layers</h2>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%203.png" /></p>
<pre><code class="language-Python">layers = adata.layers
&quot;&quot;&quot;
Layers with keys: raw
&quot;&quot;&quot;
</code></pre>
<pre><code class="language-Python">&quot;&quot;&quot;
原始数据为每个细胞中每个基因的表达量
&quot;&quot;&quot;

raw_layer = layers[&quot;raw&quot;]
&quot;&quot;&quot;
&lt;Compressed Sparse Row sparse matrix of dtype 'int64'
        with 2076576 stored elements and shape (2638, 11505)&gt;
  Coords        Values
  (0, 19)       1
  (0, 52)       1
  (0, 58)       2
  (0, 118)      1
  (0, 131)      1
  ...
  (2637, 11493) 1
  (2637, 11494) 7
  (2637, 11498) 1
  (2637, 11501) 1
  (2637, 11504) 3
&quot;&quot;&quot;

raw_df = pd.DataFrame(raw_layer.todense(), index=adata.obs_names, columns=adata.var_names)
raw_df = pd.DataFrame(raw_layer.toarray(), index=adata.obs_names, columns=adata.var_names)
raw_df = adata.to_df(layer=&quot;raw&quot;)
&quot;&quot;&quot;
gene_names        LINC00115  NOC2L  KLHL17  PLEKHN1  HES4  ISG15  AGRN  C1orf159  ...  MT-ATP6  MT-CO3  MT-ND3  MT-ND4L  MT-ND4  MT-ND5  MT-ND6  MT-CYB
cell_barcode                                                                      ...                                                                  
AAACATACAACCAC-1          0      0       0        0     0      0     0         0  ...        5       5       1        0      10       1       0       4
AAACATTGAGCTAC-1          0      0       0        0     0      0     0         0  ...       11      15       2        0      33       1       0       8
AAACATTGATCAGC-1          0      0       0        0     0      1     0         0  ...        0       4       0        0       3       2       0       4
AAACCGTGCTTCCG-1          0      0       0        0     0      9     0         0  ...        5       4       0        1       3       2       0       2
AAACCGTGTATGCG-1          0      0       0        0     0      0     0         0  ...        0       1       0        0       0       2       0       1
...                     ...    ...     ...      ...   ...    ...   ...       ...  ...      ...     ...     ...      ...     ...     ...     ...     ...
TTTCGAACTCTCAT-1          0      0       0        0     0     14     0         0  ...        0       8       1        0       1       0       0       1
TTTCTACTGAGGCA-1          0      0       0        0     0      1     0         0  ...        0       7       0        1       2       1       0       4
TTTCTACTTCCTCG-1          0      0       0        0     0      0     0         0  ...        4       7       0        0       7       0       0       4
TTTGCATGAGAGGC-1          0      0       0        0     0      0     0         0  ...        2       2       0        1       0       0       0       1
TTTGCATGCCTCAC-1          0      0       0        0     0      0     0         0  ...        0       1       0        0       1       0       0       3

[2638 rows x 11505 columns]
&quot;&quot;&quot;

genes_of_interest = [&quot;CD8A&quot;, &quot;CD4&quot;, &quot;KLRB1&quot;]
fig = plt.figure(figsize=(20, 5))
ax = fig.add_subplot(1, 2, 1)
ax.set_title(&quot;raw counts&quot;)
sc.pl.matrixplot(
    adata,
    groupby=&quot;louvain_cell_types&quot;,
    var_names=genes_of_interest,
    layer=&quot;raw&quot;,
    ax=ax,
    show=True
)
</code></pre>
<pre><code class="language-Python">layers[&quot;counts_per_million&quot;] = raw_layer.copy()
&quot;&quot;&quot;
Layers with keys: raw, counts_per_million
&quot;&quot;&quot;

# 每个细胞中每个基因的表达比例*10**6
sc.pp.normalize_total(adata, target_sum=10**6, layer=&quot;counts_per_million&quot;, inplace=True)
</code></pre>
<pre><code class="language-Python">cpm_layer = layers[&quot;counts_per_million&quot;]
&quot;&quot;&quot;
&lt;Compressed Sparse Row sparse matrix of dtype 'float64'
        with 2076576 stored elements and shape (2638, 11505)&gt;
  Coords        Values
  (0, 19)       431.77892918825563
  (0, 52)       431.77892918825563
  (0, 58)       863.5578583765113
  (0, 118)      431.77892918825563
  (0, 131)      431.77892918825563
  ...
  (2637, 11493) 527.9831045406547
  (2637, 11494) 3695.881731784583
  (2637, 11498) 527.9831045406547
  (2637, 11501) 527.9831045406547
  (2637, 11504) 1583.949313621964
&quot;&quot;&quot;

cpm_df = pd.DataFrame(cpm_layer.todense(), index=adata.obs_names, columns=adata.var_names)
cpm_df = pd.DataFrame(cpm_layer.toarray(), index=adata.obs_names, columns=adata.var_names)
cpm_df = adata.to_df(layer=&quot;counts_per_million&quot;)
&quot;&quot;&quot;
gene_names        LINC00115  NOC2L  KLHL17  PLEKHN1  HES4        ISG15  ...      MT-ND3      MT-ND4L       MT-ND4       MT-ND5  MT-ND6       MT-CYB
cell_barcode                                                            ...                                                                        
AAACATACAACCAC-1        0.0    0.0     0.0      0.0   0.0     0.000000  ...  431.778929     0.000000  4317.789292   431.778929     0.0  1727.115717
AAACATTGAGCTAC-1        0.0    0.0     0.0      0.0   0.0     0.000000  ...  424.358158     0.000000  7001.909612   212.179079     0.0  1697.432633
AAACATTGATCAGC-1        0.0    0.0     0.0      0.0   0.0   334.001336  ...    0.000000     0.000000  1002.004008   668.002672     0.0  1336.005344
AAACCGTGCTTCCG-1        0.0    0.0     0.0      0.0   0.0  3560.126582  ...    0.000000   395.569620  1186.708861   791.139241     0.0   791.139241
AAACCGTGTATGCG-1        0.0    0.0     0.0      0.0   0.0     0.000000  ...    0.000000     0.000000     0.000000  2157.497303     0.0  1078.748652
...                     ...    ...     ...      ...   ...          ...  ...         ...          ...          ...          ...     ...          ...
TTTCGAACTCTCAT-1        0.0    0.0     0.0      0.0   0.0  4221.954162  ...  301.568154     0.000000   301.568154     0.000000     0.0   301.568154
TTTCTACTGAGGCA-1        0.0    0.0     0.0      0.0   0.0   307.408546  ...    0.000000   307.408546   614.817092   307.408546     0.0  1229.634184
TTTCTACTTCCTCG-1        0.0    0.0     0.0      0.0   0.0     0.000000  ...    0.000000     0.000000  4345.127250     0.000000     0.0  2482.929857
TTTGCATGAGAGGC-1        0.0    0.0     0.0      0.0   0.0     0.000000  ...    0.000000  1025.641026     0.000000     0.000000     0.0  1025.641026
TTTGCATGCCTCAC-1        0.0    0.0     0.0      0.0   0.0     0.000000  ...    0.000000     0.000000   527.983105     0.000000     0.0  1583.949314   

[2638 rows x 11505 columns]
&quot;&quot;&quot;

genes_of_interest = [&quot;CD8A&quot;, &quot;CD4&quot;, &quot;KLRB1&quot;]
fig = plt.figure(figsize=(20, 5))
ax = fig.add_subplot(1, 2, 2)
sc.pl.matrixplot(
    adata,
    groupby=&quot;louvain_cell_types&quot;,
    var_names=genes_of_interest,
    layer=&quot;counts_per_million&quot;,
    ax=ax,
    show=False
)
ax.set_title(&quot;CPM normalization&quot;)
plt.show()
</code></pre>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%204.png" /></p>
<h2 id="observations-x-nobs">细胞信息(observations x n)：obs</h2>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%205.png" /></p>
<pre><code>储存为DataFrame对象
</code></pre>
<pre><code class="language-Python">obs = adata.obs
&quot;&quot;&quot;
                    n_genes  percent_mito  n_counts louvain_cell_types
cell_barcode                                                        
AAACATACAACCAC-1      781      0.030178    2419.0        CD4 T cells
AAACATTGAGCTAC-1     1352      0.037936    4903.0            B cells
AAACATTGATCAGC-1     1131      0.008897    3147.0        CD4 T cells
AAACCGTGCTTCCG-1      960      0.017431    2639.0    CD14+ Monocytes
AAACCGTGTATGCG-1      522      0.012245     980.0           NK cells
...                   ...           ...       ...                ...
TTTCGAACTCTCAT-1     1155      0.021104    3459.0    CD14+ Monocytes
TTTCTACTGAGGCA-1     1227      0.009294    3443.0            B cells
TTTCTACTTCCTCG-1      622      0.021971    1684.0            B cells
TTTGCATGAGAGGC-1      454      0.020548    1022.0            B cells
TTTGCATGCCTCAC-1      724      0.008065    1984.0        CD4 T cells

[2638 rows x 4 columns]
&quot;&quot;&quot;

obs_index = obs.index
&quot;&quot;&quot;
Index(['AAACATACAACCAC-1', 'AAACATTGAGCTAC-1', 'AAACATTGATCAGC-1',
       'AAACCGTGCTTCCG-1', 'AAACCGTGTATGCG-1', 'AAACGCACTGGTAC-1',
       'AAACGCTGACCAGT-1', 'AAACGCTGGTTCTT-1', 'AAACGCTGTAGCCA-1',
       'AAACGCTGTTTCTG-1',
       ...
       'TTTCAGTGTCACGA-1', 'TTTCAGTGTCTATC-1', 'TTTCAGTGTGCAGT-1',
       'TTTCCAGAGGTGAG-1', 'TTTCGAACACCTGA-1', 'TTTCGAACTCTCAT-1',
       'TTTCTACTGAGGCA-1', 'TTTCTACTTCCTCG-1', 'TTTGCATGAGAGGC-1',
       'TTTGCATGCCTCAC-1'],
      dtype='object', name='cell_barcode', length=2638)
&quot;&quot;&quot;

obs_columns = obs.columns
&quot;&quot;&quot;
Index(['n_genes', 'percent_mito', 'n_counts', 'louvain_cell_types'], dtype='object')
&quot;&quot;&quot;
</code></pre>
<h2 id="variables-x-nvar">基因信息(variables x n)：var</h2>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%206.png" /></p>
<p>储存为DataFrame对象</p>
<pre><code class="language-Python">var = adata.var
&quot;&quot;&quot;
           gene_names  n_cells         gene_ids
gene_names                                     
LINC00115   LINC00115       18  ENSG00000225880
NOC2L           NOC2L      258  ENSG00000188976
KLHL17         KLHL17        9  ENSG00000187961
PLEKHN1       PLEKHN1        7  ENSG00000187583
HES4             HES4      145  ENSG00000188290
...               ...      ...              ...
MT-ND4L       MT-ND4L      398  ENSG00000212907
MT-ND4         MT-ND4     2588  ENSG00000198886
MT-ND5         MT-ND5     1399  ENSG00000198786
MT-ND6         MT-ND6      249  ENSG00000198695
MT-CYB         MT-CYB     2517  ENSG00000198727

[11505 rows x 3 columns]
&quot;&quot;&quot;

var_index = var.index
&quot;&quot;&quot;
Index(['LINC00115', 'NOC2L', 'KLHL17', 'PLEKHN1', 'HES4', 'ISG15', 'AGRN',
       'C1orf159', 'TNFRSF18', 'TNFRSF4',
       ...
       'MT-CO2', 'MT-ATP8', 'MT-ATP6', 'MT-CO3', 'MT-ND3', 'MT-ND4L', 'MT-ND4',
       'MT-ND5', 'MT-ND6', 'MT-CYB'],
      dtype='object', name='gene_names', length=11505)
&quot;&quot;&quot;

var_columns = var.columns
&quot;&quot;&quot;
Index(['gene_names', 'n_cells', 'gene_ids'], dtype='object')
&quot;&quot;&quot;
</code></pre>
<h2 id="observations-nobsm">多维细胞注释(observations × n)：obsm</h2>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%207.png" /></p>
<p>储存为二维数组</p>
<pre><code class="language-Python">obsm = adata.obsm
&quot;&quot;&quot;
AxisArrays with keys: X_pca, X_tsne, X_umap
&quot;&quot;&quot;
</code></pre>
<pre><code class="language-Python">pca = obsm[&quot;X_pca&quot;]
pca_shape = pca.shape     # (2638, 50)
&quot;&quot;&quot;
[[ 5.556233    0.2577139  -0.18681023 ...  0.02760133  2.6710324  -0.29762036]
 [ 7.20953     7.4819846   0.16270587 ...  2.930932    0.3541974  -1.081801  ]
 [ 2.6944375  -1.5836583  -0.6631259  ...  1.0847819   0.3814702   0.06466176]
 ...
 [ 0.7853974   6.7185917   1.5988477  ... -1.1818857   0.9509114  -0.29782164]
 [-0.2812718   5.921856    1.1628779  ... -0.93838155  0.3433971  -1.0069869 ]
 [ 0.09076738  0.66350496  0.13484418 ...  1.6905508   0.26859125  -0.9084492 ]]
&quot;&quot;&quot;

pca_df = pd.DataFrame(pca, index=adata.obs_names)
&quot;&quot;&quot;
                         0         1         2         3         4         5   ...        44        45        46        47        48        49
cell_barcode                                                                   ...
AAACATACAACCAC-1   5.556233  0.257714 -0.186810  2.800131 -0.033783 -0.189702  ... -0.686898 -1.419867 -2.865078  0.027601  2.671032 -0.297620        
AAACATTGAGCTAC-1   7.209530  7.481985  0.162706 -8.018575  3.012900  0.322293  ...  0.955408  0.068133 -0.883082  2.930932  0.354197 -1.081801        
AAACATTGATCAGC-1   2.694438 -1.583658 -0.663126  2.205649 -1.686360 -1.965395  ... -0.831818 -0.236549  1.883515  1.084782  0.381470  0.064662        
AAACCGTGCTTCCG-1 -10.143295 -1.368530  1.209812 -0.700096 -2.872336  0.230617  ...  0.543566  3.156763  1.691134 -0.301377 -0.225427  0.962879        
AAACCGTGTATGCG-1  -1.112816 -8.152788  1.332405 -4.252473  2.036407  5.597797  ...  0.586381  0.636326 -1.451625  1.809683 -0.087072 -0.737833        
...                     ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...        
TTTCGAACTCTCAT-1  -9.601189 -0.180182  1.452586 -0.237521  5.016192 -2.838224  ...  0.145743  3.023428  0.584328 -0.985668 -0.653246 -0.255705        
TTTCTACTGAGGCA-1   2.847881  3.722198 -0.217027 -4.692667 -0.201969  0.136037  ...  2.293771 -1.135456 -0.613224 -0.121579  0.416659  1.059371        
TTTCTACTTCCTCG-1   0.785397  6.718592  1.598848 -4.170253 -0.792333  0.984998  ... -0.895456 -1.512018  0.383293 -1.181886  0.950911 -0.297822        
TTTGCATGAGAGGC-1  -0.281272  5.921856  1.162878 -7.346007 -0.433892 -0.143446  ...  2.175339 -1.710460 -1.163464 -0.938382  0.343397 -1.006987        
TTTGCATGCCTCAC-1   0.090767  0.663505  0.134844  2.715871 -1.046663  0.234724  ... -0.557173 -0.257671 -0.363603  1.690551  0.268591 -0.908449

[2638 rows x 50 columns]
&quot;&quot;&quot;

fig = plt.figure(figsize = (15,15))
ax = fig.add_subplot(2,2,1)
sns.scatterplot(
                data=pca_df,
                x=0,
                y=1,
                hue=obs.loc[:, &quot;louvain_cell_types&quot;]
                )
ax.set_title(&quot;PCA&quot;)
ax.axis(&quot;off&quot;)
plt.show()
</code></pre>
<pre><code class="language-Python">tsne = obsm[&quot;X_tsne&quot;]
tsne_shape = tsne.shape    # (2638, 2)
&quot;&quot;&quot;
[[13.15872094  7.006185  ]
 [37.95347415  6.56070167]
 [-2.55932453 -3.56711525]
 ...
 [32.12078558 -0.81853631]
 [36.0870687  -3.09092694]
 [-2.94501324  9.52100551]]
&quot;&quot;&quot;

tsne_df = pd.DataFrame(tsne, index=adata.obs_names)
&quot;&quot;&quot;
                          0          1
cell_barcode
AAACATACAACCAC-1  13.158721   7.006185
AAACATTGAGCTAC-1  37.953474   6.560702
AAACATTGATCAGC-1  -2.559325  -3.567115
AAACCGTGCTTCCG-1 -32.373788  -2.071373
AAACCGTGTATGCG-1   7.196922 -27.119968
...                     ...        ...
TTTCGAACTCTCAT-1 -21.379159  -6.220417
TTTCTACTGAGGCA-1  34.445376   3.751619
TTTCTACTTCCTCG-1  32.120786  -0.818536
TTTGCATGAGAGGC-1  36.087069  -3.090927
TTTGCATGCCTCAC-1  -2.945013   9.521006

[2638 rows x 2 columns]
&quot;&quot;&quot;

fig = plt.figure(figsize = (15,15))
ax = fig.add_subplot(2,2,2)
sns.scatterplot(
                data=tsne_df,
                x=0,
                y=1,
                hue=obs.loc[:, &quot;louvain_cell_types&quot;],
                )
ax.set_title(&quot;t-SNE&quot;)
ax.axis(&quot;off&quot;)
plt.show()
</code></pre>
<pre><code class="language-Python">umap = obsm[&quot;X_umap&quot;]
umap_shape = umap.shape    # (2638, 2)
&quot;&quot;&quot;
[[ 1.35285574  2.26612719]
 [-0.47802448  7.87730423]
 [ 2.16588875 -0.24481226]
 ...
 [ 0.34670979  8.34967798]
 [ 0.19864146  9.56698797]
 [ 2.62803322  0.36722543]]
&quot;&quot;&quot;

umap_df = pd.DataFrame(umap, index=adata.obs_names)
&quot;&quot;&quot;
                         0         1
cell_barcode
AAACATACAACCAC-1  1.352856  2.266127
AAACATTGAGCTAC-1 -0.478024  7.877304
AAACATTGATCAGC-1  2.165889 -0.244812
AAACCGTGCTTCCG-1 -8.695493  4.516541
AAACCGTGTATGCG-1  2.065218 -4.185123
...                    ...       ...
TTTCGAACTCTCAT-1 -9.092272  5.392429
TTTCTACTGAGGCA-1 -0.129078  7.488598
TTTCTACTTCCTCG-1  0.346710  8.349678
TTTGCATGAGAGGC-1  0.198641  9.566988
TTTGCATGCCTCAC-1  2.628033  0.367225

[2638 rows x 2 columns]
&quot;&quot;&quot;

fig = plt.figure(figsize = (15,15))
ax = fig.add_subplot(2,2,3)
sns.scatterplot(
                data=umap_df,
                x=0,
                y=1,
                hue=obs.loc[:, &quot;louvain_cell_types&quot;],
                )
ax.set_title(&quot;UMAP&quot;)
ax.axis(&quot;off&quot;)
plt.show()
</code></pre>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%208.png" /></p>
<h2 id="variables-x-nvarm">多维基因注释(variables x n)：varm</h2>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%209.png" /></p>
<p>储存为二维数组，操作同obsm</p>
<pre><code class="language-Python">varm = adata.varm
&quot;&quot;&quot;
AxisArrays with keys: 
&quot;&quot;&quot;
</code></pre>
<h2 id="observations-observationsobsp">配对细胞数据(observations × observations)：obsp</h2>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%2010.png" /></p>
<p>储存为成对细胞-细胞二维数组</p>
<pre><code class="language-Python">obsp = adata.obsp
&quot;&quot;&quot;
PairwiseArrays with keys: distances_all
&quot;&quot;&quot;
</code></pre>
<pre><code class="language-Python">distances_all = obsp[&quot;distances_all&quot;]
distances_all_shape = distances_all.shape    # (2638, 2638)
&quot;&quot;&quot;
[[ 0.         18.98223389 15.39625646 ... 17.44791227 19.66225537  13.4530516 ]
 [18.98223389  0.         21.37320952 ... 17.39917931 16.59099551  20.29010799]
 [15.39625646 21.37320952  0.         ... 17.48199881 19.54703132  13.22466662]
 ...
 [17.44791227 17.39917931 17.48199881 ...  0.         14.53959947  14.15720293]
 [19.66225537 16.59099551 19.54703132 ... 14.53959947  0.          16.96518854]
 [13.4530516  20.29010799 13.22466662 ... 14.15720293 16.96518854   0.        ]]
&quot;&quot;&quot;

distances_all_sorted = adata[obs.sort_values(by=&quot;louvain_cell_types&quot;).index, :].obsp[&quot;distances_all&quot;]
distances_all_df = pd.DataFrame(distances_all_sorted, index=adata.obs_names, columns=adata.obs_names)
&quot;&quot;&quot;
cell_barcode      AAACATACAACCAC-1  AAACATTGAGCTAC-1  AAACATTGATCAGC-1  ...  TTTCTACTTCCTCG-1  TTTGCATGAGAGGC-1  TTTGCATGCCTCAC-1
cell_barcode                                                            ...                                                      
AAACATACAACCAC-1          0.000000         16.104582         14.325944  ...         76.593592         31.585287         23.444168
AAACATTGAGCTAC-1         16.104582          0.000000         14.296034  ...         76.680071         30.718100         23.483993
AAACATTGATCAGC-1         14.325944         14.296034          0.000000  ...         76.569770         32.117569         23.052329
AAACCGTGCTTCCG-1         15.520631         15.872469         13.664186  ...         76.411524         30.303859         21.365050
AAACCGTGTATGCG-1         12.881724         14.350844         11.769647  ...         76.188423         29.946851         21.060596
...                            ...               ...               ...  ...               ...               ...               ...
TTTCGAACTCTCAT-1         65.862369         64.294692         65.532948  ...         33.617291         46.140674         53.813607
TTTCTACTGAGGCA-1         41.696160         40.825239         41.954897  ...         51.643448         28.894290         35.182130
TTTCTACTTCCTCG-1         76.593592         76.680071         76.569770  ...          0.000000         59.064268         67.991645
TTTGCATGAGAGGC-1         31.585287         30.718100         32.117569  ...         59.064268          0.000000         24.214457
TTTGCATGCCTCAC-1         23.444168         23.483993         23.052329  ...         67.991645         24.214457          0.000000

[2638 rows x 2638 columns]
&quot;&quot;&quot;

fig = plt.figure(figsize = (15, 15))
ax = fig.gca()
sns.heatmap(distances_all_df, ax=ax)
ax.set_aspect(&quot;equal&quot;)
plt.show()
</code></pre>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%2011.png" /></p>
<h2 id="variables-x-variables-varp">配对基因数据(variables x variables )：varp</h2>
<p><img alt="image.png" src="../01.f42be259-849d-43ee-bd34-e610de1f0ede/image%2012.png" /></p>
<p>储存为成对基因-基因二维数组，操作同obsp</p>
<pre><code class="language-Python">varp = adata.varp
&quot;&quot;&quot;
PairwiseArrays with keys: 
&quot;&quot;&quot;
</code></pre>
<h2 id="uns">非结构化注释：uns</h2>
<pre><code class="language-Python">uns = adata.uns
&quot;&quot;&quot;
{
 'louvain': {
             'params': {
                        'random_state': array([0]), 
                        'resolution': array([1])
                        }
             }, 
 'louvain_colors': array(['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', 
                          '#9467bd', '#8c564b', '#e377c2', '#bcbd22'], dtype=object), 
 'pca': {
         'variance': array([32.11044  , 18.718647 , 15.607319 , 13.235274 ,  4.8012376,
                             3.977329 ,  3.5053132,  3.1576602,  3.028463 ,  2.9777625,
                             2.8842385,  2.8583548,  2.849085 ,  2.8220255,  2.811057 ,
                             2.781576 ,  2.7436602,  2.7404478,  2.736062 ,  2.6872916,
                             2.671316 ,  2.6690092,  2.6442325,  2.6394093,  2.6157827,
                             2.6102393,  2.575101 ,  2.5691617,  2.563295 ,  2.5489197,
                             2.5080354,  2.4762378,  2.264355 ,  2.1844513,  2.1353922,
                             2.096509 ,  2.0606086,  2.0105643,  1.9703175,  1.9465197,
                             1.9220033,  1.8847997,  1.8349565,  1.8038161,  1.7930729,
                             1.7611799,  1.7322571,  1.721284 ,  1.6937429,  1.6519767], dtype=float32), 
         'variance_ratio': array([0.02012818, 0.01173364, 0.00978333, 0.00829643, 0.00300962,
                                  0.00249316, 0.00219728, 0.00197936, 0.00189837, 0.00186659,
                                  0.00180796, 0.00179174, 0.00178593, 0.00176896, 0.00176209,
                                  0.00174361, 0.00171984, 0.00171783, 0.00171508, 0.00168451,
                                  0.00167449, 0.00167305, 0.00165752, 0.00165449, 0.00163968,
                                  0.00163621, 0.00161418, 0.00161046, 0.00160678, 0.00159777,
                                  0.00157214, 0.00155221, 0.00141939, 0.00136931, 0.00133855,
                                  0.00131418, 0.00129168, 0.00126031, 0.00123508, 0.00122016,
                                  0.00120479, 0.00118147, 0.00115023, 0.00113071, 0.00112397,
                                  0.00110398, 0.00108585, 0.00107897, 0.00106171, 0.00103553], dtype=float32)
         }
}
&quot;&quot;&quot;

uns_keys = uns.keys()
&quot;&quot;&quot;
dict_keys(['louvain', 'louvain_colors', 'pca'])
&quot;&quot;&quot;
</code></pre>
<h1 id="_4">参考</h1>
<p><a href="https://scverse-tutorials.readthedocs.io/en/latest/notebooks/anndata_getting_started.html">Getting started with the anndata package</a></p>
<p><a href="https://single-cell-tutorial.readthedocs.io/zh/latest/Introduction/1-4/">1-4 分析框架和工具 - single_cell_tutorial Readthedocs</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>